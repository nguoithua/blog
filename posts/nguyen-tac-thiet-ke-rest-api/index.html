<!DOCTYPE html><html lang="vi-VN" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="color-scheme" content="dark light"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Nguyên tắc thiết kế REST API" /><meta name="author" content="Nhan Vo" /><meta property="og:locale" content="vi_VN" /><meta name="description" content="REST (Representational State Transfer) có thể hiểu đơn giản là một chuẩn thiết kế phần mềm, nó quy định cách mà client và server sẽ tương tác với nhau." /><meta property="og:description" content="REST (Representational State Transfer) có thể hiểu đơn giản là một chuẩn thiết kế phần mềm, nó quy định cách mà client và server sẽ tương tác với nhau." /><link rel="canonical" href="https://nguoithua.net/posts/nguyen-tac-thiet-ke-rest-api/" /><meta property="og:url" content="https://nguoithua.net/posts/nguyen-tac-thiet-ke-rest-api/" /><meta property="og:site_name" content="Nhân" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-04-21T00:00:00+07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Nguyên tắc thiết kế REST API" /><meta property="fb:admins" content="100012924845672" /><meta name="google-site-verification" content="YS_lAE0vYruMmpFuohJl36FCfOkt_BnRS1_Lz2OlgsY" /> <script type="application/ld+json"> {"description":"REST (Representational State Transfer) có thể hiểu đơn giản là một chuẩn thiết kế phần mềm, nó quy định cách mà client và server sẽ tương tác với nhau.","headline":"Nguyên tắc thiết kế REST API","dateModified":"2021-04-21T00:00:00+07:00","datePublished":"2021-04-21T00:00:00+07:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://nguoithua.net/posts/nguyen-tac-thiet-ke-rest-api/"},"url":"https://nguoithua.net/posts/nguyen-tac-thiet-ke-rest-api/","author":{"@type":"Person","name":"Nhan Vo"},"@type":"BlogPosting","@context":"https://schema.org"}</script><title>Nguyên tắc thiết kế REST API | Nhân</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4631416325082129" crossorigin="anonymous"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-C5Y7RFGJ2Z"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-C5Y7RFGJ2Z'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://cdn.jsdelivr.net/gh/xcaro/cdn-storage/commons/unknow.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Nhân</a></div><div class="site-subtitle font-italic">Người thừa.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>home</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>categories</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>tags</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>archives</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>about</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/xcaro" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://www.linkedin.com/in/nhanvht" aria-label="linkedin" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://nhanvht.medium.com" aria-label="medium" class="order-5" target="_blank" rel="noopener"> <i class="fab fa-medium"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Nguyên tắc thiết kế REST API</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Nguyên tắc thiết kế REST API</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Nhan Vo </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Apr 21, 2021, 12:00 AM +0700" prep="on" > Apr 21, 2021 <i class="unloaded">2021-04-21T00:00:00+07:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1329 words">7 min</span></div></div><div class="post-content"><p>REST (Representational State Transfer) có thể hiểu đơn giản là một chuẩn thiết kế phần mềm, nó quy định cách mà client và server sẽ tương tác với nhau.</p><p>Theo mình, việc thiết kế REST API là một việc hết sức khó khăn, nó không đơn giản như chỉ cần client gọi được là xong. Đôi khi, bạn sẽ bắt gặp những cuộc tranh luận xoay quoanh vấn đề nên viết thế này, không nên viết thế kia hoặc đôi khi bạn sẽ gặp vấn đề không biết viết API thế nào mặc dù tầng nghiệp vụ đã xong. Để giải quyết vấn đề đó, chúng ta cần quy chuẩn cách tạo API cũng như yêu cầu về chất lượng thiết kế API cho hệ thống.</p><p>Với mình, một hệ thống có chất lượng thiết kế API tối cần đáp ứng những yếu tố sau:</p><ol><li><strong>Self-documenting</strong> - nhìn vào API có thể đoán được nó dùng để làm gì.<li><strong>Flexible</strong> - khả năng mở rộng, cũng như tuỳ biến cao.<li><strong>Unified structure and attribute names</strong> - thống nhất về cấu trúc resource và cách đặt tên cho attributes.<li><strong>Clear error message</strong> - thông báo lỗi rõ ràng và chi tiết.</ol><p>Như vậy, Để đáp ứng những những yếu tố trên thì chúng ta sẽ phải tuân thủ các nguyên tắc sau đây:</p><h2 id="1-sử-dụng-http-method-để-mô-tả-về-chức-năng-của-resource">1. Sử dụng HTTP method để mô tả về chức năng của resource:</h2><p>Chúng ta có 4 HTTP method cơ bản bao gồm POST, GET, PUT, DELETE. Với mỗi method sẽ ứng với một chức năng tương ứng của API là tạo, đọc, sửa và xoá.</p><div class="table-wrapper"><table><thead><tr><th>Resources<th>GET<th>POST<th>PUT<th>DELETE<tbody><tr><td><code class="language-plaintext highlighter-rouge">/photos</code><td>Return a list of photos<td>Create a new photo<td>Bulk update of photos<td>Delete all photos<tr><td><code class="language-plaintext highlighter-rouge">/photos/{id}</code><td>Return a specific photo<td>Method not allowed<td>Edit photo if exists<td>Delete photo</table></div><h2 id="2-sử-dụng-danh-từ-số-nhiều-không-dùng-động-từ">2. Sử dụng danh từ số nhiều, không dùng động từ:</h2><p>Như thế này:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>/cars
/photos
/users
</pre></table></code></div></div><p>Không phải thế này:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>/getAllUsers
/createUser
/deleteUser
</pre></table></code></div></div><h2 id="3-chỉ-dùng-danh-từ-số-nhiều">3. Chỉ dùng danh từ số nhiều:</h2><p>Rất nhiều người hay có thói quen dùng lẫn lộn giữa danh từ số ít và danh từ số nhiều. Lời khuyên là hãy giữ mọi thứ đơn giản và chỉ sử dụng danh từ số nhiều cho tất cả các resource.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>/photos instead of /photo
/users instead of /user
/products instead of /product
/cars instead of /car
</pre></table></code></div></div><h2 id="4-liên-kết-trong-resource">4. Liên kết trong resource:</h2><p>Thông thường chúng ta sẽ có rất nhiều resource có quan hệ đến nhau và việc thiết kế liên kiết cho những resource đó là việc hết sức đau đầu.</p><p>Nếu chúng ta có 2 resources là <code class="language-plaintext highlighter-rouge">photos</code> và <code class="language-plaintext highlighter-rouge">users</code>. Bây giờ ta cần lấy tất cả photo của user cụ thể, ta sẽ có API sau:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>GET /users/123/cars
</pre></table></code></div></div><p>Như vậy, nếu ta muốn xem một <code class="language-plaintext highlighter-rouge">photo</code> cụ thể của một <code class="language-plaintext highlighter-rouge">user</code>, ta sẽ có 2 cách:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>GET /users/123/cars/5
GET /cars/5
</pre></table></code></div></div><p>Tuỳ theo yêu cầu kỹ thuật mà ta sẽ có response khác nhau cho 2 resource đó.</p><p>Thêm một lưu ý nữa, mỗi reosurce chỉ nên liên kết tối đa 2 object. Và việc liên kết quá nhiều sẽ làm cho resource trở nên rối mắt. Ví dụ:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>GET /forums/1/discussions/123/replies/23
</pre></table></code></div></div><p><strong>Lời khuyên:</strong> Với các api truy vấn dữ liệu dạng filter với nhiều param thì có thể dùng cú pháp như sau:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>GET /forums/1/filter?properties.discussions=123&amp;properties.replies=23
</pre></table></code></div></div><p>Xây dựng sẵn bộ điều kiện truy vấn đơn giản gồm các thành phần như sau:</p><ul><li><code class="language-plaintext highlighter-rouge">neq</code>: không bằng<li><code class="language-plaintext highlighter-rouge">gt</code>: lớn hơn<li><code class="language-plaintext highlighter-rouge">gte</code>: lớn hơn bằng<li><code class="language-plaintext highlighter-rouge">lt</code>: nhỏ hơn<li><code class="language-plaintext highlighter-rouge">lte</code>: nhỏ hơn bằng<li><code class="language-plaintext highlighter-rouge">in</code>: có trong<li><code class="language-plaintext highlighter-rouge">not_in</code>: không trong</ul><h2 id="5-versioning">5. Versioning:</h2><p>Versioning là một điều bắt buộc với tất cả resource, việc đánh version cho resource tuân thủ 2 nguyên tắc sau:</p><ul><li>Bắt đầu bằng <code class="language-plaintext highlighter-rouge">v</code> và kết thúc bằng một số nguyên dương , tránh dùng số thập phân (dùng <code class="language-plaintext highlighter-rouge">v1</code> thay vì <code class="language-plaintext highlighter-rouge">v1.5</code>)<li>Versioning sẽ được đặt ở vị trí đầu tiên của resource</ul><p>Ví dụ:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>GET /v1/users
</pre></table></code></div></div><p>Thay vì</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>GET /v1.1/users
</pre></table></code></div></div><h2 id="6-đặt-tên-cho-attribute">6. Đặt tên cho attribute:</h2><p>Xem ví dụ sau:</p><p><strong>Vimeo:</strong></p><div class="language-json highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"created_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-03-05T21:04:47+00:00"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p><strong>Youtube:</strong></p><div class="language-json highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"publishAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-09-01T12:00:00.0Z"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>Ta có thể nhìn thấy các dạng khác nhau. Chúng ta sẽ không nói đến cách nào đúng cách nào sai, mỗi team sẽ tự chọn cho mình một cách và tuân thủ cách viết đó cho toàn project.</p><p>Ngoài ra, chúng ta cũng nên chú ý đến việc thống nhất một danh từ cho một attribute cụ thể. Có rất nhiều bạn mặc lỗi là dùng nhiều danh từ khác nhau để nói về cùng 1 loại attribute (<code class="language-plaintext highlighter-rouge">user_id</code> và <code class="language-plaintext highlighter-rouge">user</code> cùng được sử dụng khi muốn lấy <code class="language-plaintext highlighter-rouge">user_id</code> hay <code class="language-plaintext highlighter-rouge">from_date</code> và <code class="language-plaintext highlighter-rouge">from</code> cùng được sử dụng khi muốn lấy <code class="language-plaintext highlighter-rouge">from_date</code>)</p><p>Tóm lại tuân thủ 2 nguyên tắc sau:</p><ul><li>Thống nhất 1 loại convention.<li>Thống nhất naming cho cùng 1 loại attribute.</ul><h2 id="7-phân-trang">7. Phân trang.</h2><p>Xem xét cách lấy 25 phần tử từ vị trí thứ 50 của 3 hệ thống sau:</p><ul><li>Facebook: <code class="language-plaintext highlighter-rouge">offset</code> 50 and <code class="language-plaintext highlighter-rouge">limit</code> 25.<li>Twitter: <code class="language-plaintext highlighter-rouge">page</code> 3 and <code class="language-plaintext highlighter-rouge">rpp</code> 25 (records per page).<li>LinkedIn: <code class="language-plaintext highlighter-rouge">start</code> 50 and <code class="language-plaintext highlighter-rouge">count</code> 25.</ul><p>Trong trường hợp này, mình thiên về cách sử dung của facebook vì nó trực quan và dễ hiểu hơn. Ngoài ra, những bạn nào đã code database thì khái niệm <code class="language-plaintext highlighter-rouge">limit</code> và <code class="language-plaintext highlighter-rouge">offset</code> cũng không phải là một khái niệm gì mới.</p><h2 id="8-tìm-kiếm">8. Tìm kiếm.</h2><p>Quy tắc: <code class="language-plaintext highlighter-rouge">attribute</code> tên là <code class="language-plaintext highlighter-rouge">q</code> (query)</p><p>Global search:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>GET /search?q=foo+bar
</pre></table></code></div></div><p>Scope search:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>GET /users/123/photos?q=foo+bar
</pre></table></code></div></div><h2 id="9-chọn-field-trả-về">9. Chọn field trả về.</h2><p>Trong một số trường hợp, client sẽ không cần đầy đủ thông tin của một object. Ví dụ như phiên bản mobile sẽ không lấy hết thông tin của user như phiên bản web. Chính vì vậy chúng ta cần resource có khả năng tuỳ chỉnh những field trả về. Việc này làm tăng performance cho phía client.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>GET /users?fields=id,name,address
</pre></table></code></div></div><h2 id="10-định-dạng-dữ-liệu-trả-về">10. Định dạng dữ liệu trả về.</h2><p>Đối với những resource hỗ trợ nhiều định dạng dữ liệu trả về, HTTP-Header sẽ là nơi để xác định dịnh dạng đó.</p><ul><li><code class="language-plaintext highlighter-rouge">Content-Type</code>: Khai báo request format.<li><code class="language-plaintext highlighter-rouge">Accept</code>: Khai báo response format.</ul><h2 id="11-http-status-code-và-error-message">11. HTTP status code và error message.</h2><p>Chuẩn HTTP cung cấp cho ta rất nhiều status code. Chúng ta sẽ không cần biết hết tất cả nhưng ít nhất nên biết đến những status code cơ bản này:</p><h3 id="2xx---success">2xx - Success:</h3><ul><li><code class="language-plaintext highlighter-rouge">200 OK</code> — This is most commonly used HTTP code to show that the operation performed is successful.<li><code class="language-plaintext highlighter-rouge">201 Created</code> — This can be used when you use POST method to create a new resource.<li><code class="language-plaintext highlighter-rouge">202 Accepted</code> — This can be used to acknowledge the request sent to the server.</ul><h3 id="4xx---client-error">4xx - Client Error</h3><ul><li><code class="language-plaintext highlighter-rouge">400 Bad Request</code> — This can be used when client side input validation fails.<li><code class="language-plaintext highlighter-rouge">401 Unauthorized</code> / <code class="language-plaintext highlighter-rouge">403 Forbidden</code> — This can be used if the user or the system is not authorised to perform certain operation.<li><code class="language-plaintext highlighter-rouge">404 Not Found</code> — This can be used if you are looking for certain resource and it is not available in the system.</ul><h3 id="5xx---server-error">5xx - Server Error</h3><ul><li><code class="language-plaintext highlighter-rouge">500 Internal Server Error</code> — This should never be thrown explicitly but might occur if the system fails.<li><code class="language-plaintext highlighter-rouge">502 Bad Gateway</code> — This can be used if server received an invalid response from the upstream server.</ul><p>Đối với error message trả về khi có lỗi xảy ra cần đảm báo dễ hiểu cho cả user, frontend developer và backend developer. Về cơ bản chúng ta sẽ có 3 message trả về phục vụ cho 3 đối tượng khác nhau:</p><ul><li><code class="language-plaintext highlighter-rouge">user_message</code> (message trả về cho user).<li><code class="language-plaintext highlighter-rouge">internal_message</code> (message trả vể cho backend developer).<li><code class="language-plaintext highlighter-rouge">code</code> (message trả về cho frontend developer).</ul><p>Như vậy, một message đầy đủ sẽ có dạng sau:</p><div class="language-json highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"user_message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sorry, the requested resource does not exist."</span><span class="p">,</span><span class="w">
    </span><span class="nl">"internal_message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"No car found in the database."</span><span class="p">,</span><span class="w">
    </span><span class="nl">"code"</span><span class="p">:</span><span class="w"> </span><span class="mi">6004</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/software-engineering/'>Software Engineering</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/rest-api/" class="post-tag no-text-decoration" >rest api</a> <a href="/tags/rest/" class="post-tag no-text-decoration" >rest</a> <a href="/tags/api/" class="post-tag no-text-decoration" >api</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Nguyên tắc thiết kế REST API - Nhân&url=https://nguoithua.net/posts/nguyen-tac-thiet-ke-rest-api/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Nguyên tắc thiết kế REST API - Nhân&u=https://nguoithua.net/posts/nguyen-tac-thiet-ke-rest-api/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Nguyên tắc thiết kế REST API - Nhân&url=https://nguoithua.net/posts/nguyen-tac-thiet-ke-rest-api/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-tags"> <span>trending tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/api/">api</a> <a class="post-tag" href="/tags/rest-api/">rest api</a> <a class="post-tag" href="/tags/rest/">rest</a> <a class="post-tag" href="/tags/software-architecture/">software architecture</a> <a class="post-tag" href="/tags/tips/">tips</a> <a class="post-tag" href="/tags/full-text/">full-text</a> <a class="post-tag" href="/tags/fulltext-search/">fulltext search</a> <a class="post-tag" href="/tags/laravel/">Laravel</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/refactor/">refactor</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>further reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/chuan-hoa-du-lieu-trong-rest-api/"><div class="card-body"> <span class="timeago small" > Apr 19, 2021 <i class="unloaded">2021-04-19T00:00:00+07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Chuẩn hoá dữ liệu trong REST API</h3><div class="text-muted small"><p> Có 2 thứ không thể bỏ qua được trong một API, đó là request và response. Như là khi bạn thấy đâu đó một API, thứ đầu tiên mà bạn nghĩ request của API đó là gì, response là gì. Công việc hằng ngày...</p></div></div></a></div><div class="card"> <a href="/posts/full-text-search-nghia-la-gi/"><div class="card-body"> <span class="timeago small" > Mar 14, 2021 <i class="unloaded">2021-03-14T00:00:00+07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Full-text search nghĩa là gì?</h3><div class="text-muted small"><p> Full-text search chứ không phải full text-search. Full-text với không full-text Ví dụ bài viết có 3 phần: Tiêu đề Các tag Thân bài Nếu khi search, ta chỉ cho search trong tiêu đề và các ...</p></div></div></a></div><div class="card"> <a href="/posts/tu-tho-den-thay-refactor/"><div class="card-body"> <span class="timeago small" > Mar 14, 2021 <i class="unloaded">2021-03-14T00:00:00+07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Từ thợ đến thầy - Refactor</h3><div class="text-muted small"><p> Khi chương trình tiến hoá, sẽ cần suy tính lại những quyết định cũ và bắt tay sửa lại chương trình. Việc sửa lại, cấu trúc lại chương trình mà giữ nguyên tính năng gọi là refactor. Việc này trên lí...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/chuan-hoa-du-lieu-trong-rest-api/" class="btn btn-outline-primary" prompt="older"><p>Chuẩn hoá dữ liệu trong REST API</p></a> <span class="btn btn-outline-primary disabled" prompt="newer"><p>-</p></span></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/xcaro">Nhan Vo</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."> Some rights reserved. </span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">trending tags</h4><a class="post-tag" href="/tags/api/">api</a> <a class="post-tag" href="/tags/rest-api/">rest api</a> <a class="post-tag" href="/tags/rest/">rest</a> <a class="post-tag" href="/tags/software-architecture/">software architecture</a> <a class="post-tag" href="/tags/tips/">tips</a> <a class="post-tag" href="/tags/full-text/">full text</a> <a class="post-tag" href="/tags/fulltext-search/">fulltext search</a> <a class="post-tag" href="/tags/laravel/">Laravel</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/refactor/">refactor</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://nguoithua.net{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
